sudo: required

services:
  - docker

env:
  - DOVECOT=release-2.2.21 IMAPTEST=62dce2a6c372bdc674a6ece356985c6ecbaa7304
  - DOVECOT=2.2.33.1 IMAPTEST=core-2.2
  - DOVECOT=master IMAPTEST=master
  - DOVECOT=master-2.2 IMAPTEST=core-2.2
  
script:
  - docker build --build-arg DOVECOT=$DOVECOT --build-arg IMAPTEST=$IMAPTEST -t travis-build build
  - docker images

after_success:
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
  - docker tag travis-build cephdovecot/travis-build:$DOVECOT
  - docker push cephdovecot/travis-build:$DOVECOT;
